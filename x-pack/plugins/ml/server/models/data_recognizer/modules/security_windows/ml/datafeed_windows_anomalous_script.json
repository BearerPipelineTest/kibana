{
  "job_id": "windows_anomalous_script",
  "indices": [
    "INDEX_PATTERN_NAME"
  ],
  "max_empty_searches": 10,
  "query": {
    "bool": {
      "filter": [
        {
          "term": {
            "event.provider": "Microsoft-Windows-PowerShell"
          }
        }
      ],
      "must": [
        {
          "bool": {
            "should": [
              {
                "match": {
                  "host.os.family": {
                    "query": "windows",
                    "operator": "OR"
                  }
                }
              },
              {
                "match": {
                  "host.os.type": {
                    "query": "windows",
                    "operator": "OR"
                  }
                }
              }
            ]
          }
        }
      ]
    }
  }
}
